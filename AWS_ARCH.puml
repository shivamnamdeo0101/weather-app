@startuml
title 🌍 Global Weather App — AWS Multi-Region Unified Pod Architecture

' --- Layout Settings ---
skinparam packagePadding 15
skinparam rectangle {
    Shadowing false
    RoundCorner 10
    Padding 8
    MinWidth 180
}
skinparam database {
    Shadowing false
    RoundCorner 10
    Padding 8
    MinWidth 160
}
skinparam cloud {
    Shadowing false
}

actor USER
cloud OPENWEATHER as "OpenWeather API"

' ===========================
' AWS GLOBAL INFRASTRUCTURE
' ===========================
package "AWS Global Infrastructure" {

    ' -------- ASIA REGION --------
    package "Region: Asia (Singapore - ap-southeast-1)" {
        rectangle POD_ASIA as "Weather Service Pod\n(Frontend + API + Scheduler + Redis)"
    }

    ' -------- EUROPE REGION --------
    package "Region: Europe (Frankfurt - eu-central-1)" {
        rectangle POD_EU as "Weather Service Pod\n(Frontend + API + Scheduler + Redis)"
    }

    ' -------- AFRICA REGION --------
    package "Region: Africa (South Africa - af-south-1)" {
        rectangle POD_AF as "Weather Service Pod\n(Frontend + API + Scheduler + Redis)"
    }

    ' -------- AMERICAS REGION --------
    package "Region: Americas (US East + São Paulo)" {
        rectangle POD_US as "Weather Service Pod — US East (us-east-1)\n(Frontend + API + Scheduler + Redis)"
        rectangle POD_SA as "Weather Service Pod — São Paulo (sa-east-1)\n(Frontend + API + Scheduler + Redis)"
    }

    ' -------- OCEANIA REGION --------
    package "Region: Oceania (Sydney - ap-southeast-2)" {
        rectangle POD_OC as "Weather Service Pod\n(Frontend + API + Scheduler + Redis)"
    }
}

' ===========================
' GLOBAL SERVICES
' ===========================
cloud CF as "Amazon CloudFront (CDN)"
rectangle R53 as "Route 53 (Latency-Based Routing)"

' ===========================
' GLOBAL CONNECTION FLOW
' ===========================

USER --> CF : Initial Page Load (Static Assets)
USER --> R53 : API Endpoint (Latency-Based DNS)

' CloudFront → Regional Pods (Frontend)
CF --> POD_ASIA
CF --> POD_EU
CF --> POD_AF
CF --> POD_US
CF --> POD_SA
CF --> POD_OC

' Route 53 → Regional Pods (API Traffic)
R53 --> POD_ASIA
R53 --> POD_EU
R53 --> POD_AF
R53 --> POD_US
R53 --> POD_SA
R53 --> POD_OC

' ===========================
' REGIONAL DATA FLOW
' ===========================

POD_ASIA --> OPENWEATHER : Fetch Forecast / Current Weather
POD_EU --> OPENWEATHER
POD_AF --> OPENWEATHER
POD_US --> OPENWEATHER
POD_SA --> OPENWEATHER
POD_OC --> OPENWEATHER

' ===========================
' SYSTEM CONSTRAINTS
' ===========================
note bottom of OPENWEATHER
<b>CONSTRAINTS:</b>
- MAX_CITIES_OPEN_WEATHER = 200,000
- PER_CITY_DATA_SIZE_IN_REDIS = 8 KB
- MAX_REDIS_MEMORY = 1.6 GB GLOBALLY
- PER_REGION_REDIS_MEMORY ≈ 327.68 MB (FOR 5 REGIONS)
end note

@enduml
